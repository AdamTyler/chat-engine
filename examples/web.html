<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Open Chat Framework Dev</title>

</head>

<body>

    <h1>You are <span id="me"></span></h1>

    <ul id="online-list">
    </ul>
    
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="../web/ocf.js" type="text/javascript"></script>
    <script src="../plugins/typingIndicator.js" type="text/javascript"></script>
    <script src="../plugins/randomUsername.js" type="text/javascript"></script>
    <script type="text/javascript">

   var OCF = new OCFBuilder({
        globalConfigs: 'here'
    }, [
        new typingIndicator({
            timeout: 5000
        }),
        new randomUsername()
    ]);

    var me = OCF.identify(new Date().getTime(), {value: true});

    $('#me').text(me.data.state.username + '(' + me.data.uuid + ')');

    var chat = new OCF.Chat('online-list-tester');

    chat.emitter.on('online-list', (users) => {

        $('#online-list').empty();

        for(var i in users) {
            $('#online-list').append('<li>' + users[i].data.state.username  + '</li>');
        }

    });

    chat.emitter.on('state-change', (packet) => {
        console.log('state-chante', packet)
    });


    chat.emitter.on('join', (payload) => {
        console.log('got join', payload);
    });

    chat.emitter.on('message', (payload) => {
        console.log('got message', payload.sender, payload.data);
    });


    chat.emitter.on('ready', () => {

    });

  </script>
</body>
</html>
