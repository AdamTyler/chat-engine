<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Open Chat Framework Dev</title>

</head>

<body>
    
    <div id="chat">
    </div>
    <input type="text" id="message">
    <input type="submit" id="submit">
    <div id="typing"></div>

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <script src="web/ocf.js" type="text/javascript"></script>
  <script src="plugins/typingIndicator.js" type="text/javascript"></script>
  <script type="text/javascript">

    var OCF = new OCFBuilder({
        globalConfigs: 'here'
    }, [
        new typingIndicator()
    ]);

    let me = new OCF.User('ian', {value: true});

    let john = new OCF.User('john', {value: true});
    let mary = new OCF.User('mary', {value: true});

    var chat = me.createChat([john, mary]);

    chat.emitter.on('message', (payload) => {
        console.log('got message', payload);

        $('#chat').append($('<div>' + payload.data.text + '</div>'));

    });

    $('#message').on('change keyup paste click blur', () => {
        chat.typing.startTyping();
    });

    $('#submit').click(() => {
        
        chat.typing.stopTyping();

        chat.publish('message', {
            text: $('#message').val()
        });

        $('#message').val('');

    });

    chat.emitter.on('startTyping', (payload) => {
        $('#typing').text('Typing...');
    });

    chat.emitter.on('stopTyping', (payload) => {
        $('#typing').text('');
    });

    chat.emitter.on('ready', () => {

    });

    

  </script>
</body>
</html>
